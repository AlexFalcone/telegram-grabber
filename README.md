# Telegram Grabber
Бот позволяет пересылать весь контент с любого telegram канала (если админ канала не запретил копирование контента) на ваш


# Используемые библиотеки

Для работы бота необходимо установить библиотеки.
Библиотека aiogram:

    pip install aiogram

Библиотека telethon:   
 
    pip install telethon

# Как запустить

1. Создать телеграм-бота. Для этого нужно написать боту [BotFather]([url](https://telegram.me/botfather)) и следовать инструкциям. После этого сохраните токен бота.
2. Получить api_id, api_hash. Сделать это можно на сайте [my.telegram.org]([url](https://my.telegram.org/auth)).
3. Задать переменные api_id, api_hash и bot_token в файле main.py.

![image](https://user-images.githubusercontent.com/91873172/236864151-bc15d37b-d1dc-4abf-bdf7-71c8268d4d3f.png)

_пример_

Запустить бота командой:

    python main.py

# Пример использования:
1. Добавляем id каналов, с которых нужно брать контнт командой /add_channel (/add_channel -2312312312). 
id нужного канала можно узнать переслав любое сообщение с канала в бот [Get My ID]([url](https://t.me/getmyid_bot))
![image](https://user-images.githubusercontent.com/91873172/236866756-06b5a78f-0b58-45f2-a238-ce6e40550b8a.png)

2. Добавить канал, на который должны будут приходить сообщения командой /add_destination_channel (/add_destination_channel -321312311). Бот, который вы создали в начале обязательно должен быть администратором этого канала.
3. Указать соответсвие между каналами написав id канала-источника и id канала-получателя через пробел командой /set_channel_mapping (/set_channel_mapping -100123132890 -1000932314321). Теперь все новые сообщения, которые будут публиковать будут приходить на ваш канал.
4. Также вам доступна команда

    /last_messages ко-во сообщений или all, если все.
    
Она отправляет последние сообщения на ваш канал. Если добавили несколько каналов-источников, а последние сообщения нужны только с одного канала, то напишите

    /last_messages id канала источника ко-во сообщений
    
# Список доступных команд:
* /start - Начало работы с ботом
* /help - Получить список доступных команд
* /add_channel - Добавить канал для работы
* /remove_channel - Удалить канал из списка
* /list_channels - Показать список добавленных каналов
* /add_destination_channel - Добавить канал-получатель
* /remove_destination_channel - Удалить канал-получатель из списка
* /list_destination_channels - Показать список каналов-получателей
* /set_channel_mapping - Установить соответствие между каналами
* /last_messages (ко-во сообщений или all, если все) - Отправить последние сообщения с каналов



Бот после того, как вы добавите все каналы и зададите соответсвие командой /set_channel_mapping (пример: /set_channel_mapping -10013113890 -10321314321) в каналах командой каналах, и aiogram для обработки команд пользователей и отправки сообщений в чат бота. Сообщения в исходном канале могут быть как текстовыми, так и содержать медиа-файлы (фото, документы).

Когда бот обнаруживает новое сообщение в исходном канале, он заменяет все упоминания пользователей на новое значение, заданное в переменной new_link, и пересылает его во все заданные каналы.

Также бот умеет обрабатывать альбомы (группы сообщений, содержащих медиа-файлы) и пересылать их в заданный канал в виде одного сообщения с общим описанием и медиа-файлами.

Списки идентификаторов каналов хранятся в файле *.pickle для сохранения настроек после перезапуска бота.
